<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <title>üõ©Ô∏è Aviator Predictor</title>

  <style>

    body {

      font-family: Arial, sans-serif;

      background: #111;

      color: #f0f0f0;

      padding: 20px;

    }

    input, button {

      padding: 10px;

      margin: 5px;

      border: none;

      border-radius: 6px;

      font-size: 16px;

    }

    button {

      background-color: #1e90ff;

      color: white;

      cursor: pointer;

    }

    button:hover {

      background-color: #0077cc;

    }

    .info {

      margin-top: 10px;

      font-size: 18px;

    }

    .history {

      margin-top: 15px;

      max-height: 160px;

      overflow-y: auto;

      border-top: 1px solid #444;

    }

    .item {

      padding: 6px;

      border-bottom: 1px solid #333;

      font-size: 15px;

    }

  </style>

</head>

<body>



  <h1>üõ©Ô∏è Aviator Predictor</h1>

  <div id="balance" class="info">üí∞ Balance: R10.00</div>

  <div id="streamStatus" class="info">Live: Not connected</div>



  <input type="text" id="inputData" placeholder="e.g. 1.2, 2.5, 3.1..." size="40" />

  <br/>

  <input type="number" id="betAmount" placeholder="Bet Amount (e.g. 1)" />

  <input type="number" step="0.1" id="targetMultiplier" placeholder="Target Multiplier (e.g. 2)" />

  <br/>

  <button onclick="predictAndBet()">üéØ Predict & Bet</button>

  <button onclick="resetAll()">‚ôªÔ∏è Reset</button>



  <div class="info" id="status">Enter your data to start.</div>

  <div class="info" id="prediction">--</div>

  <div class="info" id="result">--</div>



  <div class="history" id="historyList"></div>



  <script>

    let balance = 10;

    let historyList = [];



    window.onload = function() {

      const saved = localStorage.getItem("aviator_data");

      if (saved) {

        const data = JSON.parse(saved);

        balance = data.balance || 10;

        historyList = data.history || [];

        updateBalance();

        updateHistory();

      }

      connectLiveData();

    };



    function saveData() {

      localStorage.setItem("aviator_data", JSON.stringify({

        balance,

        history: historyList

      }));

    }



    function updateBalance() {

      document.getElementById("balance").innerText = `üí∞ Balance: R${balance.toFixed(2)}`;

    }



    function updateHistory() {

      document.getElementById("historyList").innerHTML = historyList.map(i => `<div class="item">${i}</div>`).join("");

    }



    function predictAndBet() {

      const input = document.getElementById("inputData").value;

      const parts = input.split(",").map(x => parseFloat(x.trim())).filter(x => !isNaN(x));

      const bet = parseFloat(document.getElementById("betAmount").value);

      const target = parseFloat(document.getElementById("targetMultiplier").value);



      if (parts.length < 2 || isNaN(bet) || isNaN(target)) {

        document.getElementById("status").innerText = "‚ö†Ô∏è Fill all fields correctly.";

        return;

      }



      if (bet > balance || bet <= 0) {

        document.getElementById("status").innerText = "‚ùå Invalid or insufficient bet.";

        return;

      }



      document.getElementById("status").innerText = "üîç Analyzing...";

      document.getElementById("prediction").innerText = "--";

      document.getElementById("result").innerText = "--";



      setTimeout(() => {

        const avg = parts.reduce((a, b) => a + b) / parts.length;

        let predicted;

        if (avg < 1.5) predicted = (Math.random() * 2 + 1).toFixed(2);

        else if (avg < 3) predicted = (Math.random() * 3 + 1.5).toFixed(2);

        else predicted = (Math.random() * 5 + 2.5).toFixed(2);



        const rand = Math.random();

        const actual = rand < 0.01 ? 1.00 : +(Math.floor((1 / (1 - rand)) * 100) / 100).toFixed(2);



        let win = actual >= target;

        let resultText = win ? `‚úÖ WIN! You got R${(bet * target).toFixed(2)}` : `‚ùå Lost R${bet}`;

        balance += win ? (bet * target) - bet : -bet;



        document.getElementById("status").innerText = `üéØ Target: ${target}x`;

        document.getElementById("prediction").innerText = `AI Predicts: ${predicted}x`;

        document.getElementById("result").innerText = `üí• Crashed at: ${actual}x ‚Üí ${resultText}`;

        updateBalance();



        const now = new Date().toLocaleTimeString();

        historyList.unshift(`${now} ‚Üí Bet: R${bet} @ ${target}x ‚Üí Crash: ${actual}x ‚Üí ${win ? 'WIN' : 'LOSE'}`);

        if (historyList.length > 10) historyList.pop();



        updateHistory();

        saveData();

      }, 1500);

    }



    function resetAll() {

      if (confirm("Reset all data?")) {

        balance = 10;

        historyList = [];

        updateBalance();

        updateHistory();

        localStorage.removeItem("aviator_data");

        document.getElementById("status").innerText = "üîÑ Reset complete.";

        document.getElementById("prediction").innerText = "--";

        document.getElementById("result").innerText = "--";

      }

    }



    function connectLiveData() {

      try {

        const source = new EventSource("/api/stream");

        source.onmessage = function(event) {

          const data = JSON.parse(event.data);

          if (data && data.crash) {

            document.getElementById("streamStatus").innerText = `Live: Last crash ${data.crash}x`;

          }

        };

        source.onerror = function() {

          document.getElementById("streamStatus").innerText = "Live: Connection failed.";

        };

      } catch (e) {

        document.getElementById("streamStatus").innerText = "Live: Not available.";

      }

    }

  </script>

</body>

  </html>
